SELECT d_yearmonthnum, SUM(lo_revenue - lo_supplycost) AS profit FROM (SELECT LHS.s_suppkey AS s_suppkey, LHS.s_name AS s_name, LHS.s_address AS s_address, LHS.s_city AS s_city, LHS.s_nation AS s_nation, LHS.s_region AS s_region, LHS.s_phone AS s_phone, LHS.lo_orderkey AS lo_orderkey, LHS.lo_linenumber AS lo_linenumber, LHS.lo_custkey AS lo_custkey, LHS.lo_partkey AS lo_partkey, LHS.lo_orderdate AS lo_orderdate, LHS.lo_orderpriority AS lo_orderpriority, LHS.lo_shippriority AS lo_shippriority, LHS.lo_quantity AS lo_quantity, LHS.lo_extendedprice AS lo_extendedprice, LHS.lo_ordtotalprice AS lo_ordtotalprice, LHS.lo_discount AS lo_discount, LHS.lo_revenue AS lo_revenue, LHS.lo_supplycost AS lo_supplycost, LHS.lo_tax AS lo_tax, LHS.lo_commitdate AS lo_commitdate, LHS.lo_shipmode AS lo_shipmode, LHS.d_date AS d_date, LHS.d_dayofweek AS d_dayofweek, LHS.d_month AS d_month, LHS.d_year AS d_year, LHS.d_yearmonthnum AS d_yearmonthnum, LHS.d_yearmonth AS d_yearmonth, LHS.d_daynuminweek AS d_daynuminweek, LHS.d_daynuminmonth AS d_daynuminmonth, LHS.d_daynuminyear AS d_daynuminyear, LHS.d_monthnuminyear AS d_monthnuminyear, LHS.d_weeknuminyear AS d_weeknuminyear, LHS.d_sellingseason AS d_sellingseason, LHS.d_lastdayinweekfl AS d_lastdayinweekfl, LHS.d_lastdayinmonthfl AS d_lastdayinmonthfl, LHS.d_holidayfl AS d_holidayfl, LHS.d_weekdayfl AS d_weekdayfl, RHS.p_name AS p_name, RHS.p_mfgr AS p_mfgr, RHS.p_category AS p_category, RHS.p_brand1 AS p_brand1, RHS.p_color AS p_color, RHS.p_type AS p_type, RHS.p_size AS p_size, RHS.p_container AS p_container FROM (SELECT LHS.s_suppkey AS s_suppkey, LHS.s_name AS s_name, LHS.s_address AS s_address, LHS.s_city AS s_city, LHS.s_nation AS s_nation, LHS.s_region AS s_region, LHS.s_phone AS s_phone, LHS.lo_orderkey AS lo_orderkey, LHS.lo_linenumber AS lo_linenumber, LHS.lo_custkey AS lo_custkey, LHS.lo_partkey AS lo_partkey, LHS.lo_orderdate AS lo_orderdate, LHS.lo_orderpriority AS lo_orderpriority, LHS.lo_shippriority AS lo_shippriority, LHS.lo_quantity AS lo_quantity, LHS.lo_extendedprice AS lo_extendedprice, LHS.lo_ordtotalprice AS lo_ordtotalprice, LHS.lo_discount AS lo_discount, LHS.lo_revenue AS lo_revenue, LHS.lo_supplycost AS lo_supplycost, LHS.lo_tax AS lo_tax, LHS.lo_commitdate AS lo_commitdate, LHS.lo_shipmode AS lo_shipmode, RHS.d_date AS d_date, RHS.d_dayofweek AS d_dayofweek, RHS.d_month AS d_month, RHS.d_year AS d_year, RHS.d_yearmonthnum AS d_yearmonthnum, RHS.d_yearmonth AS d_yearmonth, RHS.d_daynuminweek AS d_daynuminweek, RHS.d_daynuminmonth AS d_daynuminmonth, RHS.d_daynuminyear AS d_daynuminyear, RHS.d_monthnuminyear AS d_monthnuminyear, RHS.d_weeknuminyear AS d_weeknuminyear, RHS.d_sellingseason AS d_sellingseason, RHS.d_lastdayinweekfl AS d_lastdayinweekfl, RHS.d_lastdayinmonthfl AS d_lastdayinmonthfl, RHS.d_holidayfl AS d_holidayfl, RHS.d_weekdayfl AS d_weekdayfl FROM (SELECT * FROM (SELECT LHS.s_suppkey AS s_suppkey, LHS.s_name AS s_name, LHS.s_address AS s_address, LHS.s_city AS s_city, LHS.s_nation AS s_nation, LHS.s_region AS s_region, LHS.s_phone AS s_phone, RHS.lo_orderkey AS lo_orderkey, RHS.lo_linenumber AS lo_linenumber, RHS.lo_custkey AS lo_custkey, RHS.lo_partkey AS lo_partkey, RHS.lo_orderdate AS lo_orderdate, RHS.lo_orderpriority AS lo_orderpriority, RHS.lo_shippriority AS lo_shippriority, RHS.lo_quantity AS lo_quantity, RHS.lo_extendedprice AS lo_extendedprice, RHS.lo_ordtotalprice AS lo_ordtotalprice, RHS.lo_discount AS lo_discount, RHS.lo_revenue AS lo_revenue, RHS.lo_supplycost AS lo_supplycost, RHS.lo_tax AS lo_tax, RHS.lo_commitdate AS lo_commitdate, RHS.lo_shipmode AS lo_shipmode FROM ssbm_supplier AS LHS INNER JOIN ssbm_lineorder AS RHS ON (LHS.s_suppkey = RHS.lo_suppkey) ) dbplyr_004 WHERE (s_name = 'Supplier#000047861')) LHS INNER JOIN ssbm_date AS RHS ON (LHS.lo_orderdate = RHS.d_datekey) ) LHS INNER JOIN ssbm_part_csv AS RHS ON (LHS.lo_partkey = RHS.p_partkey) ) dbplyr_005 GROUP BY d_yearmonthnum ;